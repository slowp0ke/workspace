package ru.spbstu.telematics.ivanov722.lab03;

import java.util.ArrayList;
import java.util.Random;


public class Cross {

	private static int numOfThread = 100;

	public static void main(String[] args) throws InterruptedException {

		Random random = new Random();	
		int typeNextCar;

		CriticalPoint criticalPoint = new CriticalPoint();

		TrafficLight tLSN = new TrafficLight("SN", 0,criticalPoint);
		TrafficLight tLNS = new TrafficLight("NS", 0,criticalPoint);
		TrafficLight tLWE = new TrafficLight("WE", 0,criticalPoint);
		//TrafficLight tLEW = new TrafficLight("EW", 0,criticalPoint);
		TrafficLight tLES = new TrafficLight("ES", 0,criticalPoint);



		int SN = 0;
		int NS = 0;
		int EW = 0;
		int WE = 0;
		int ES = 0;		

		ArrayList<Thread> threads = new ArrayList<Thread>();

		Thread tempThread;

		while(threads.size() < numOfThread){
			Thread.sleep(1000);
			typeNextCar = random.nextInt(5) + 1;
			switch(typeNextCar){
			case 1: tempThread = new Thread (new Car(tLSN, SN++)); tempThread.start(); threads.add(tempThread); break;
			case 2: tempThread = new Thread (new Car(tLNS, NS++)); tempThread.start(); threads.add(tempThread); break;
			case 3: tempThread = new Thread (new Car(tLWE, WE++)); tempThread.start(); threads.add(tempThread); break;
			case 4: tempThread = new Thread (new Car(tLEW, EW++)); tempThread.start(); threads.add(tempThread); break;
			case 5: tempThread = new Thread (new Car(tLES, ES++)); tempThread.start(); threads.add(tempThread); break;

			}

		}
		for(Thread th : threads){
			th.join();
		}
		System.out.println("Done!");

	}

}
